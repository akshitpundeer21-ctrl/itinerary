<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FaresMatch - Find Your Fare. Match Your Journey.</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=DM+Sans:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script type="speculationrules">
  {
    "prerender": [{"where": {"selector_matches": "[data-page]"}}]
  }
  </script>
  <style>
    @layer reset, tokens, base, layout, components, patterns, utilities, animations;

    @layer tokens {
      :root {
        /* Colors */
        --cream: #FAF6EE;
        --deep: #1A1208;
        --gold: #C9952A;
        --gold-light: #E8B84B;
        --rust: #8B3A1C;
        --muted: #8A7A60;
        --sand: #F5EFE0;
        --white: #FFFFFF;

        /* Color mix variants */
        --gold-10: color-mix(in srgb, var(--gold) 10%, transparent);
        --gold-20: color-mix(in srgb, var(--gold) 20%, transparent);
        --gold-50: color-mix(in srgb, var(--gold) 50%, transparent);
        --deep-80: color-mix(in srgb, var(--deep) 80%, transparent);

        /* Fluid typography */
        --text-xs: clamp(0.7rem, 1.5vw, 0.8rem);
        --text-sm: clamp(0.8rem, 2vw, 0.95rem);
        --text-base: clamp(0.95rem, 2.5vw, 1.05rem);
        --text-md: clamp(1.05rem, 2.5vw, 1.2rem);
        --text-lg: clamp(1.2rem, 3vw, 1.5rem);
        --text-xl: clamp(1.5rem, 4vw, 2rem);
        --text-2xl: clamp(2rem, 5vw, 2.75rem);
        --text-hero: clamp(2.5rem, 7vw, 5rem);

        /* Fluid spacing */
        --space-xs: clamp(4px, 1vw, 8px);
        --space-sm: clamp(8px, 2vw, 14px);
        --space-md: clamp(14px, 3vw, 24px);
        --space-lg: clamp(24px, 5vw, 48px);
        --space-xl: clamp(48px, 8vw, 96px);

        /* Custom properties for animations */
        --progress: 0%;
      }
    }

    @layer reset {
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'DM Sans', sans-serif;
        color: var(--deep);
        background-color: var(--cream);
        line-height: 1.6;
        overflow-x: hidden;
      }
    }

    @layer base {
      @starting-style {
        :is(.hero-text, .card, .day-accordion, .result-card) {
          opacity: 0;
          transform: translateY(20px);
        }
      }

      .fade-in {
        opacity: 1;
        transform: translateY(0);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }

      .container {
        max-width: 1200px;
        margin-inline: auto;
        padding-inline: var(--space-md);
      }

      .btn {
        padding: var(--space-sm) var(--space-md);
        border-radius: 4px;
        font-family: 'Playfair Display', serif;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        text-decoration: none;
        display: inline-block;
      }

      .btn-primary {
        background: var(--gold);
        color: var(--deep);
      }

      .btn-secondary {
        background: transparent;
        color: var(--gold);
        border: 2px solid var(--gold);
      }

      .btn:hover, .btn:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(201, 149, 42, 0.3);
      }
    }

    @layer layout {
      .navbar {
        position: fixed;
        inset-block-start: 0;
        inset-inline: 0;
        padding-block: var(--space-md);
        padding-inline: var(--space-md);
        z-index: 1000;
        backdrop-filter: blur(10px);
        background: transparent;
        border-bottom: 1px solid transparent;

        @keyframes navSolid {
          from { background: transparent; border-bottom-color: transparent; }
          to { background: color-mix(in srgb, var(--deep) 90%, transparent);
               border-bottom-color: var(--gold-20);
               box-shadow: 0 2px 20px rgba(0,0,0,0.3); }
        }

        animation: navSolid linear both;
        animation-timeline: scroll(root);
        animation-range: 0px 80px;
      }

      .nav-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        font-family: 'Playfair Display', serif;
        font-size: var(--text-xl);
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .logo-fares { color: var(--deep); }
      .logo-match { color: var(--deep); }
      .logo-dot { color: var(--gold); }

      .nav-links {
        display: none;
        gap: var(--space-lg);
      }

      .hamburger {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 30px;
        height: 30px;
        background: none;
        border: none;
        cursor: pointer;

        &:before, &:after {
          content: '';
          width: 100%;
          height: 2px;
          background: var(--gold);
          transition: all 0.3s ease;
        }

        &:before { transform: translateY(-6px) rotate(var(--top-rotation, 0)); }
        &:after { transform: translateY(6px) rotate(var(--bottom-rotation, 0)); }
      }

      .menu {
        position: fixed;
        inset-block-start: 0;
        inset-inline-end: 0;
        width: 280px;
        height: 100vh;
        background: var(--deep);
        padding: var(--space-xl);
        transform: translateX(100%);
        transition: transform 0.3s ease;
        z-index: 1001;
      }

      .hamburger:has(+ .menu[open]) {
        --top-rotation: 45deg;
        --bottom-rotation: -45deg;
      }

      .menu[open] {
        transform: translateX(0);
      }

      .page-content {
        margin-block-start: 80px;
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--space-xl);
      }

      .page {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--space-xl);
        padding-block: var(--space-xl);
        min-height: calc(100vh - 80px);
        opacity: 1;
        transition: opacity 0.3s ease;
      }

      .page[hidden] {
        display: none;
      }
    }

    @layer components {
      .hero {
        position: relative;
        min-height: 100dvh;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;

        .hero-bg {
          position: absolute;
          inset: 0;
          width: 100%;
          height: 100%;
          object-fit: cover;
          z-index: -1;

          @keyframes parallax {
            to { transform: translateY(30%); }
          }

          animation: parallax linear;
          animation-timeline: scroll(root);
          animation-range: 0px 100vh;
        }

        .hero-overlay {
          position: absolute;
          inset: 0;
          background: linear-gradient(to bottom, rgba(26, 18, 8, 0.4), rgba(26, 18, 8, 0.8));
        }

        .hero-content {
          text-align: center;
          color: var(--white);
          padding: var(--space-xl);
          max-width: 800px;
        }

        .hero-text {
          animation: fade-up 1s ease 0.2s both;
        }

        .hero-title {
          font-size: var(--text-hero);
          font-family: 'Playfair Display', serif;
          margin-bottom: var(--space-sm);
          text-wrap: balance;
        }

        .hero-subtitle {
          font-size: var(--text-lg);
          margin-bottom: var(--space-xl);
        }

        .hero-cta {
          display: flex;
          justify-content: center;
          gap: var(--space-md);
          margin-top: var(--space-lg);

          &:has(.btn:hover) .btn-secondary { background: var(--gold); color: var(--deep); }
        }

        .scroll-down {
          position: absolute;
          bottom: 40px;
          left: 50%;
          transform: translateX(-50%);
          animation: bounce 2s infinite;
        }
      }

      .section {
        padding-block: var(--space-xl);
        content-visibility: auto;
        contain-intrinsic-size: 0 500px;
      }

      .section-title {
        font-family: 'Playfair Display', serif;
        font-size: var(--text-2xl);
        text-align: center;
        margin-bottom: var(--space-xl);
        color: var(--deep);
        text-wrap: balance;
      }

      .how-it-works {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--space-lg);
        position: relative;

        &:before {
          content: '';
          position: absolute;
          top: 80px;
          left: 15%;
          right: 15%;
          height: 2px;
          background: var(--gold);
          z-index: 1;
        }

        .step {
          position: relative;
          z-index: 2;
          padding: var(--space-lg);
          text-align: center;
          background: var(--white);
          border-radius: 8px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .step-number {
          display: inline-block;
          width: 40px;
          height: 40px;
          background: var(--gold);
          color: var(--deep);
          border-radius: 50%;
          line-height: 40px;
          font-weight: 700;
          margin-bottom: var(--space-sm);
        }
      }

      .features-grid {
        container-type: inline-size;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--space-lg);

        @container (min-width: 600px) {
          .card {
            &:hover {
              transform: translateY(-4px);
            }
          }
        }
      }

      .card {
        padding: var(--space-lg);
        background: var(--white);
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;

        h3 {
          font-family: 'Playfair Display', serif;
          color: var(--deep);
          margin-bottom: var(--space-sm);
        }
      }

      .why-faresmatch {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: var(--space-lg);

        .trust-card {
          padding: var(--space-lg);
          border-radius: 8px;
          text-align: center;

          &:nth-child(1) { background: color-mix(in srgb, var(--gold) 5%, transparent); }
          &:nth-child(2) { background: color-mix(in srgb, var(--gold) 3%, transparent); }
          &:nth-child(3) { background: color-mix(in srgb, var(--gold) 10%, transparent); }
        }
      }

      .testimonials {
        display: flex;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        gap: var(--space-lg);
        padding: var(--space-md);

        &::-webkit-scrollbar {
          height: 6px;
        }

        &::-webkit-scrollbar-thumb {
          background: var(--gold);
          border-radius: 3px;
        }

        .testimonial-card {
          scroll-snap-align: start;
          min-width: 300px;
          padding: var(--space-lg);
          background: var(--white);
          border-radius: 8px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
      }
    }

    @layer patterns {
      .form-group {
        margin-bottom: var(--space-md);

        &:has(input:focus, select:focus, textarea:focus) label {
          color: var(--gold);
        }
      }

      .form-control {
        width: 100%;
        padding: var(--space-sm) var(--space-md);
        border: 2px solid var(--gold-20);
        border-radius: 4px;
        font-family: 'DM Sans', sans-serif;
        font-size: var(--text-base);
        background: var(--white);
        transition: border-color 0.3s ease;

        &:focus {
          outline: none;
          border-color: var(--gold);
        }

        &:user-valid { border-color: #28a745; }
        &:user-invalid { border-color: #dc3545; }
      }

      .tag-button {
        padding: var(--space-xs) var(--space-sm);
        margin-inline-end: var(--space-sm);
        margin-block-end: var(--space-xs);
        background: var(--sand);
        color: var(--deep);
        border: none;
        border-radius: 20px;
        cursor: pointer;
        font-size: var(--text-sm);
        transition: all 0.3s ease;

        &[aria-pressed="true"] {
          background: var(--deep);
          color: var(--gold-light);
        }
      }

      .day-accordion {
        border: 1px solid var(--gold-20);
        border-radius: 4px;
        margin-bottom: var(--space-sm);
        overflow: hidden;

        &[open] {
          .day-summary {
            background: var(--deep);
            color: var(--white);
          }

          .day-title {
            color: var(--gold-light);
          }
        }
      }

      .day-summary {
        display: flex;
        align-items: center;
        gap: var(--space-md);
        padding: var(--space-md) var(--space-lg);
        background: var(--sand);
        cursor: pointer;
        list-style: none;

        &::-webkit-details-marker {
          display: none;
        }

        &:hover {
          background: var(--gold-10);
        }
      }

      .day-number {
        font-size: var(--text-xs);
        letter-spacing: 2px;
        text-transform: uppercase;
        color: var(--gold);
        min-width: 50px;
        font-weight: 600;
      }

      .day-title {
        flex: 1;
        font-family: 'Playfair Display', serif;
        font-size: var(--text-md);
      }

      .day-arrow {
        color: var(--gold);
        transition: rotate 0.3s ease;

        .day-accordion[open] & {
          rotate: 180deg;
        }
      }

      .day-body {
        padding: var(--space-lg) var(--space-xl);
        background: var(--white);
        border-top: 1px solid var(--gold-10);
        @starting-style { opacity: 0; }
        opacity: 1;
        transition: opacity 0.3s ease;
      }

      .time-block {
        padding-block: var(--space-sm);
        border-bottom: 1px solid var(--gold-10);

        &:last-child {
          border-bottom: none;
        }
      }

      .time-label {
        font-family: 'Playfair Display', serif;
        font-style: italic;
        color: var(--rust);
        font-size: var(--text-sm);
        margin-bottom: var(--space-xs);
      }

      .tab-group {
        & #panelA, & #panelB {
          display: none;
        }

        &:has(#tabA:checked) #panelA { display: block; }
        &:has(#tabA:checked) #panelB { display: none; }
        &:has(#tabB:checked) #panelA { display: none; }
        &:has(#tabB:checked) #panelB { display: block; }

        &:has(#tabA:checked) label[for="tabA"] {
          color: var(--gold-light);
          border-bottom: 2px solid var(--gold);
        }

        &:has(#tabB:checked) label[for="tabB"] {
          color: var(--gold-light);
          border-bottom: 2px solid var(--gold);
        }
      }

      .tab-bar {
        display: flex;
        border-bottom: 1px solid var(--gold-20);
      }

      .tab-label {
        padding: var(--space-md) var(--space-lg);
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.3s ease;
      }

      .progress-bar {
        height: 8px;
        background: var(--sand);
        border-radius: 4px;
        overflow: hidden;

        .progress-fill {
          height: 100%;
          background: var(--gold);
          width: var(--progress);
          transition: --progress 1s ease;
        }
      }
    }

    @layer utilities {
      .hidden { display: none !important; }
      .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }
      .d-none { display: none; }
      .text-center { text-align: center; }
      .text-gold { color: var(--gold); }
      .bg-cream { background: var(--cream); }
      .bg-deep { background: var(--deep); }
      .bg-gold { background: var(--gold); }
      .bg-sand { background: var(--sand); }
      .color-inherit { color: inherit; }
    }

    @layer animations {
      @keyframes fade-up {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
      }

      @keyframes fade-in {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      @keyframes fade-out {
        from { opacity: 1; }
        to { opacity: 0; }
      }

      @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
        40% { transform: translateX(-50%) translateY(-10px); }
        60% { transform: translateX(-50%) translateY(-5px); }
      }

      @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(201, 149, 42, 0.4); }
        70% { box-shadow: 0 0 0 10px rgba(201, 149, 42, 0); }
        100% { box-shadow: 0 0 0 0 rgba(201, 149, 42, 0); }
      }

      @property --progress {
        syntax: '<percentage>';
        inherits: false;
        initial-value: 0%;
      }

      @keyframes reveal-up {
        from { opacity: 0; transform: translateY(40px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .reveal {
        animation: reveal-up linear both;
        animation-timeline: view();
        animation-range: entry 0% entry 40%;
      }
    }

    ::view-transition-old(root) {
      animation: 200ms ease-out both fade-out;
    }

    ::view-transition-new(root) {
      animation: 300ms ease-in both fade-in;
      animation-delay: 100ms;
    }

    @media (min-width: 768px) {
      .nav-links {
        display: flex;
      }

      .hamburger {
        display: none;
      }

      .menu {
        display: none;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    @media print {
      .navbar, .footer, .btn, .form-group, .whatsapp-btn {
        display: none !important;
      }

      .page-content {
        margin-block-start: 0;
      }

      body::before {
        content: "FaresMatch - Find Your Fare. Match Your Journey.";
        display: block;
        font-size: 1.5em;
        font-weight: bold;
        margin-bottom: 1em;
      }
    }
  </style>
</head>
<body>
  <a href="#main-content" class="sr-only">Skip to main content</a>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-content">
      <a href="#" class="logo" onclick="showPage('home')">
        <span class="logo-fares">Fares</span>
        <span class="logo-dot">‚Ä¢</span>
        <span class="logo-match">Match</span>
      </a>

      <div class="nav-links">
        <a href="#" onclick="showPage('home')">Home</a>
        <a href="#" onclick="showPage('plan')">Plan Trip</a>
        <a href="#" onclick="showPage('explore')">Explore</a>
        <a href="#" onclick="showPage('cost')">Cost</a>
        <a href="#" onclick="showPage('packing')">Packing</a>
        <a href="#" onclick="showPage('contact')">Contact</a>
      </div>

      <details class="hamburger">
        <summary aria-label="Menu"></summary>
        <div class="menu" role="menu">
          <a href="#" onclick="showPage('home')" role="menuitem">Home</a>
          <a href="#" onclick="showPage('plan')" role="menuitem">Plan Trip</a>
          <a href="#" onclick="showPage('explore')" role="menuitem">Explore</a>
          <a href="#" onclick="showPage('cost')" role="menuitem">Cost</a>
          <a href="#" onclick="showPage('packing')" role="menuitem">Packing</a>
          <a href="#" onclick="showPage('contact')" role="menuitem">Contact</a>
        </div>
      </details>
    </div>
  </nav>

  <!-- Main Content -->
  <main id="main-content" class="page-content">
    <!-- Home Page -->
    <section id="home" class="page" data-page>
      <div class="hero">
        <img src="https://images.unsplash.com/photo-1503220317375-aaad61436b1b?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80"
             alt="Beautiful travel destination"
             class="hero-bg"
             loading="lazy"
             fetchpriority="high">
        <div class="hero-overlay"></div>
        <div class="hero-content">
          <div class="hero-text">
            <h1 class="hero-title">Find Your Fare. Match Your Journey.</h1>
            <p class="hero-subtitle">Expertly crafted travel itineraries tailored to your style, budget, and dreams.</p>
            <div class="hero-cta">
              <a href="#" class="btn btn-primary" onclick="showPage('plan')">Plan My Trip</a>
              <a href="#" class="btn btn-secondary" onclick="showPage('explore')">Explore Destinations</a>
            </div>
          </div>
        </div>
        <div class="scroll-down">‚Üì</div>
      </div>

      <section class="section">
        <h2 class="section-title">How It Works</h2>
        <div class="how-it-works">
          <div class="step">
            <div class="step-number">1</div>
            <h3>Tell Us Your Dreams</h3>
            <p>Share your destination, budget, and travel style preferences.</p>
          </div>
          <div class="step">
            <div class="step-number">2</div>
            <h3>AI-Powered Planning</h3>
            <p>Our AI creates personalized itineraries with two options.</p>
          </div>
          <div class="step">
            <div class="step-number">3</div>
            <h3>Review & Enjoy</h3>
            <p>Choose your favorite, pack smart, and embark on your journey.</p>
          </div>
        </div>
      </section>

      <section class="section">
        <h2 class="section-title">Features</h2>
        <div class="features-grid">
          <div class="card reveal">
            <h3>Smart Itineraries</h3>
            <p>AI-generated travel plans that match your style and budget.</p>
          </div>
          <div class="card reveal">
            <h3>Cost Estimation</h3>
            <p>Detailed budget breakdowns for planning and peace of mind.</p>
          </div>
          <div class="card reveal">
            <h3>Packing Lists</h3>
            <p>Personalized packing suggestions based on destination and season.</p>
          </div>
          <div class="card reveal">
            <h3>Local Insights</h3>
            <p>Expert tips and cultural insights from trusted sources.</p>
          </div>
        </div>
      </section>

      <section class="section">
        <h2 class="section-title">Why FaresMatch</h2>
        <div class="why-faresmatch">
          <div class="trust-card">
            <h3>Expert Planning</h3>
            <p>Crafted by travel experts and AI for the perfect balance of adventure and comfort.</p>
          </div>
          <div class="trust-card">
            <h3>Personalized</h3>
            <p>Tailored to your unique preferences, budget, and travel style.</p>
          </div>
          <div class="trust-card">
            <h3>Time-Saving</h3>
            <p>Get expert-level planning without the hours of research.</p>
          </div>
        </div>
      </section>

      <section class="section">
        <h2 class="section-title">Testimonials</h2>
        <div class="testimonials">
          <div class="testimonial-card">
            <p>"The itinerary was perfect! Every recommendation was spot-on and we felt like locals. Our trip exceeded all expectations."</p>
            <p><strong>- Sarah M.</strong></p>
          </div>
          <div class="testimonial-card">
            <p>"FaresMatch saved us so much time planning our honeymoon. The AI suggestions were better than anything we could have found ourselves."</p>
            <p><strong>- Michael & Jane</strong></p>
          </div>
          <div class="testimonial-card">
            <p>"As a busy professional, I needed a stress-free way to plan my vacation. The cost estimator helped me stay within budget while having an amazing time."</p>
            <p><strong>- David R.</strong></p>
          </div>
        </div>
      </section>
    </section>

    <!-- Plan My Trip Page -->
    <section id="plan" class="page" data-page hidden>
      <div class="container">
        <h1 class="section-title">Plan Your Dream Trip</h1>
        <form id="itineraryForm">
          <div class="form-group">
            <label for="destination">Destination</label>
            <input type="text" id="destination" class="form-control" placeholder="Where do you want to go?" required>
          </div>

          <div class="form-group">
            <label for="duration">Duration (days)</label>
            <input type="number" id="duration" class="form-control" min="1" max="30" required>
          </div>

          <div class="form-group">
            <label for="travelers">Number of Travelers</label>
            <select id="travelers" class="form-control" required>
              <option value="">Select travelers</option>
              <option value="1">Solo</option>
              <option value="2">Couple</option>
              <option value="3">Small Group (3)</option>
              <option value="4-6">Family (4-6)</option>
              <option value="7+">Large Group (7+)</option>
            </select>
          </div>

          <div class="form-group">
            <label for="budget">Budget</label>
            <select id="budget" class="form-control" required>
              <option value="">Select budget</option>
              <option value="budget">Budget ($)</option>
              <option value="mid-range">Mid-Range ($$)</option>
              <option value="luxury">Luxury ($$$)</option>
              <option value="custom">Custom Amount</option>
            </select>
          </div>

          <div class="custom-input" style="display: none; max-height: 0; overflow: hidden; transition: max-height 0.3s ease;">
            <div class="form-group">
              <input type="text" id="custom-budget" class="form-control" placeholder="Enter custom budget amount">
            </div>
          </div>

          <div class="form-group">
            <label>Travel Styles</label>
            <div>
              <button type="button" class="tag-button" data-style="adventure">Adventure</button>
              <button type="button" class="tag-button" data-style="relaxation">Relaxation</button>
              <button type="button" class="tag-button" data-style="cultural">Cultural</button>
              <button type="button" class="tag-button" data-style="food">Food</button>
              <button type="button" class="tag-button" data-style="nature">Nature</button>
              <button type="button" class="tag-button" data-style="luxury">Luxury</button>
            </div>
          </div>

          <div class="form-group">
            <label>Special Requests</label>
            <textarea id="special" class="form-control" rows="3" field-sizing="content" placeholder="Any special requirements or interests?"></textarea>
          </div>

          <button type="submit" class="btn btn-primary">Generate Itinerary</button>
        </form>

        <div id="itineraryResults" class="mt-4" aria-live="polite"></div>
      </div>
    </section>

    <!-- Destination Explorer Page -->
    <section id="explore" class="page" data-page hidden>
      <div class="container">
        <h1 class="section-title">Explore Destinations</h1>
        <search role="search">
          <input type="search" id="destinationSearch" class="form-control" inputmode="search" placeholder="Search for destinations..." autocomplete="off">
        </search>

        <div id="searchResults" class="mt-4">
          <!-- Results will be populated here -->
        </div>
      </div>
    </section>

    <!-- Cost Estimator Page -->
    <section id="cost" class="page" data-page hidden>
      <div class="container">
        <h1 class="section-title">Cost Estimator</h1>
        <form id="costForm">
          <div class="form-group">
            <label for="cost-destination">Destination</label>
            <input type="text" id="cost-destination" class="form-control" placeholder="Enter destination" required>
          </div>

          <div class="form-group">
            <label for="cost-duration">Duration (days)</label>
            <input type="number" id="cost-duration" class="form-control" min="1" max="30" required>
          </div>

          <div class="form-group">
            <label for="cost-travelers">Number of Travelers</label>
            <select id="cost-travelers" class="form-control" required>
              <option value="1">1 Person</option>
              <option value="2">2 People</option>
              <option value="3">3 People</option>
              <option value="4">4 People</option>
              <option value="5+">5+ People</option>
            </select>
          </div>

          <div class="form-group">
            <label for="cost-accommodation">Accommodation Style</label>
            <select id="cost-accommodation" class="form-control" required>
              <option value="budget">Budget (Hostels, Guesthouses)</option>
              <option value="mid-range">Mid-Range (3-4 Stars)</option>
              <option value="luxury">Luxury (5 Stars)</option>
            </select>
          </div>

          <div class="form-group">
            <label for="cost-style">Travel Style</label>
            <select id="cost-style" class="form-control" required>
              <option value="backpacker">Backpacker</option>
              <option value="standard">Standard</option>
              <option value="comfortable">Comfortable</option>
              <option value="luxury">Luxury</option>
            </select>
          </div>

          <button type="submit" class="btn btn-primary">Estimate Costs</button>
        </form>

        <div id="costResults" class="mt-4" aria-live="polite"></div>
      </div>
    </section>

    <!-- Packing List Page -->
    <section id="packing" class="page" data-page hidden>
      <div class="container">
        <h1 class="section-title">Packing Assistant</h1>
        <form id="packingForm">
          <div class="form-group">
            <label for="pack-destination">Destination</label>
            <input type="text" id="pack-destination" class="form-control" placeholder="Where are you going?" required>
          </div>

          <div class="form-group">
            <label for="pack-duration">Trip Duration</label>
            <select id="pack-duration" class="form-control" required>
              <option value="weekend">Weekend (2-3 days)</option>
              <option value="week">Week (4-7 days)</option>
              <option value="two-weeks">Two Weeks (8-14 days)</option>
              <option value="month">Month (15+ days)</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pack-season">Season</label>
            <select id="pack-season" class="form-control" required>
              <option value="spring">Spring</option>
              <option value="summer">Summer</option>
              <option value="fall">Fall/Autumn</option>
              <option value="winter">Winter</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pack-trip-type">Trip Type</label>
            <select id="pack-trip-type" class="form-control" required>
              <option value="beach">Beach/Relaxing</option>
              <option value="adventure">Adventure/Outdoors</option>
              <option value="city">City/Cultural</option>
              <option value="business">Business</option>
              <option value="family">Family</option>
            </select>
          </div>

          <button type="submit" class="btn btn-primary">Generate Packing List</button>
        </form>

        <div id="packingResults" class="mt-4" aria-live="polite"></div>
      </div>
    </section>

    <!-- Contact Page -->
    <section id="contact" class="page" data-page hidden>
      <div class="container">
        <h1 class="section-title">Contact Us</h1>
        <div class="row">
          <div class="col-md-6">
            <address class="contact-info">
              <h3>FaresMatch Travel Agency</h3>
              <p>123 Travel Street</p>
              <p>Adventure City, AC 12345</p>
              <p>Phone: (555) 123-4567</p>
              <p>Email: hello@faresmatch.com</p>
            </address>
          </div>

          <div class="col-md-6">
            <form id="contactForm">
              <div class="form-group">
                <label for="contact-name">Name</label>
                <input type="text" id="contact-name" class="form-control" required autocomplete="name">
              </div>

              <div class="form-group">
                <label for="contact-email">Email</label>
                <input type="email" id="contact-email" class="form-control" required autocomplete="email">
              </div>

              <div class="form-group">
                <label for="contact-subject">Subject</label>
                <input type="text" id="contact-subject" class="form-control" required>
              </div>

              <div class="form-group">
                <label for="contact-message">Message</label>
                <textarea id="contact-message" class="form-control" rows="5" field-sizing="content" required></textarea>
              </div>

              <button type="submit" class="btn btn-primary">Send Message</button>
            </form>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer bg-deep text-center">
      <div class="container">
        <div class="logo">
          <span class="logo-fares" style="color: white;">Fares</span>
          <span class="logo-dot" style="color: var(--gold);">‚Ä¢</span>
          <span class="logo-match" style="color: white;">Match</span>
        </div>
        <p style="color: var(--sand); margin: var(--space-md) 0;">Find Your Fare. Match Your Journey.</p>
        <p style="color: var(--muted); font-size: var(--text-sm);">&copy; 2025 FaresMatch. All rights reserved.</p>
      </div>
    </footer>
  </main>

  <!-- Dialogs -->
  <dialog id="loadingDialog">
    <div class="dialog-content">
      <h3>Generating Your Itinerary...</h3>
      <div class="progress-bar">
        <div class="progress-fill" style="--progress: 50%"></div>
      </div>
      <p>Please wait while we create your personalized travel plan.</p>
    </div>
  </dialog>

  <dialog id="successDialog">
    <div class="dialog-content">
      <h3>Success!</h3>
      <p>Your itinerary has been generated successfully.</p>
      <button onclick="successDialog.close()">Close</button>
    </div>
  </dialog>

  <script>
    // Configuration for Qwen API
    const QWEN_API_KEY = 'sk-048bf1161bfcb600-ilydm5-e1bc4c32';
    const QWEN_MODEL = 'qwen3-coder-plus';
    const MAX_TOKENS = 1500;

    // Global state
    let currentActivePage = 'home';
    const selectedStyles = [];

    // DOM Elements
    const loadingDialog = document.getElementById('loadingDialog');
    const successDialog = document.getElementById('successDialog');
    const itineraryResults = document.getElementById('itineraryResults');
    const searchResults = document.getElementById('searchResults');
    const costResults = document.getElementById('costResults');
    const packingResults = document.getElementById('packingResults');

    // Initialize the application
    function init() {
      // Add event listeners for budget selection to show/hide custom input
      const budgetSelect = document.getElementById('budget');
      const customInput = document.querySelector('.custom-input');

      budgetSelect.addEventListener('change', function() {
        if (this.value === 'custom') {
          customInput.style.display = 'block';
          customInput.style.maxHeight = '80px';
        } else {
          customInput.style.display = 'none';
          customInput.style.maxHeight = '0';
        }
      });

      // Add event listeners for tag buttons
      const styleButtons = document.querySelectorAll('.tag-button');
      styleButtons.forEach(button => {
        button.addEventListener('click', function() {
          const style = this.getAttribute('data-style');
          if (this.getAttribute('aria-pressed') === 'true') {
            this.setAttribute('aria-pressed', 'false');
            const index = selectedStyles.indexOf(style);
            if (index > -1) selectedStyles.splice(index, 1);
          } else {
            this.setAttribute('aria-pressed', 'true');
            selectedStyles.push(style);
          }
        });
      });

      // Form submissions
      document.getElementById('itineraryForm').addEventListener('submit', handleItinerarySubmit);
      document.getElementById('costForm').addEventListener('submit', handleCostSubmit);
      document.getElementById('packingForm').addEventListener('submit', handlePackingSubmit);
      document.getElementById('contactForm').addEventListener('submit', handleContactSubmit);
    }

    // Page switching with View Transitions (global functions for HTML onclick)
    function showPage(pageName) {
      if (currentActivePage === pageName) return;

      const currentPage = document.getElementById(currentActivePage);
      const newPage = document.getElementById(pageName);

      if (!newPage) return;

      if (!document.startViewTransition) {
        _switchPage(pageName);
        return;
      }

      document.startViewTransition(() => _switchPage(pageName));
    }

    function _switchPage(pageName) {
      document.getElementById(currentActivePage).hidden = true;
      document.getElementById(pageName).hidden = false;
      currentActivePage = pageName;
    }

    // Qwen API Call Function (Modified for your API)
    async function callQwen(prompt) {
      const abortController = new AbortController();
      const signal = abortController.signal;

      // Timeout after 35 seconds
      const timeoutId = setTimeout(() => abortController.abort(), 35000);

      try {
        const response = await fetch('https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions', {
          signal,
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${QWEN_API_KEY}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            model: QWEN_MODEL,
            messages: [{ role: 'user', content: prompt }],
            max_tokens: MAX_TOKENS
          })
        });

        clearTimeout(timeoutId);

        if (!response.ok) {
          throw new Error(`Qwen API error: ${response.status}`,
            { cause: await response.text() });
        }

        const data = await response.json();
        return data.choices[0]?.message?.content ?? '';
      } catch (error) {
        clearTimeout(timeoutId);
        if (error.name === 'AbortError') {
          throw new Error('Request timed out after 35 seconds');
        }
        throw error;
      }
    }

    // Itinerary generation handler
    async function handleItinerarySubmit(e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const dest = formData.get('destination');
      const dur = formData.get('duration');
      const trav = formData.get('travelers');
      let budget = formData.get('budget');
      if (budget === 'custom') {
        budget = document.getElementById('custom-budget').value || 'flexible';
      }
      const special = formData.get('special');
      const styles = selectedStyles.join(', ');

      if (!dest || !dur || !trav) {
        alert('Please fill in all required fields');
        return;
      }

      // Show loading dialog
      loadingDialog.showModal();

      try {
        // Generate two itinerary options
        const promptA = `Expert travel planner. Vivid itinerary (Option A ‚Äî classic route):
Destination: ${dest}, Duration: ${dur}, Travelers: ${trav},
Budget: ${budget}, Style: ${styles}${special ? ', Special: '+special : ''}
Format EXACTLY: 2-sentence intro paragraph, then each day as:
## Day X: [Themed Title]
### Morning
[content]
### Afternoon
[content]
### Evening
[content]
End with: ## Practical Tips
[5 numbered tips]
Tone: inspiring, personal, concise.`;

        const promptB = `Expert travel planner. Vivid itinerary (Option B ‚Äî alternative route with hidden gems):
Destination: ${dest}, Duration: ${dur}, Travelers: ${trav},
Budget: ${budget}, Style: ${styles}${special ? ', Special: '+special : ''}
Format EXACTLY: 2-sentence intro paragraph, then each day as:
## Day X: [Themed Title]
### Morning
[content]
### Afternoon
[content]
### Evening
[content]
End with: ## Practical Tips
[5 numbered tips]
Tone: inspiring, personal, concise.`;

        const [resultA, resultB] = await Promise.all([
          callQwen(promptA),
          callQwen(promptB)
        ]);

        // Render the results
        itineraryResults.innerHTML = `
          <div class="tab-group">
            <input type="radio" name="itab" id="tabA" checked hidden>
            <input type="radio" name="itab" id="tabB" hidden>
            <div class="tab-bar">
              <label for="tabA" class="tab-label">‚ú¶ Option A ‚Äî Classic</label>
              <label for="tabB" class="tab-label">‚ú¶ Option B ‚Äî Alternative</label>
            </div>
            <div class="tab-panels">
              <div class="tab-panel" id="panelA">
                ${renderItineraryAccordion(resultA)}
              </div>
              <div class="tab-panel" id="panelB">
                ${renderItineraryAccordion(resultB)}
              </div>
            </div>
          </div>
        `;

        // Close loading dialog and show success
        loadingDialog.close();
        successDialog.showModal();
      } catch (error) {
        loadingDialog.close();
        alert('Error generating itinerary: ' + error.message);
        console.error('Itinerary generation error:', error);
      }
    }

    // Render itinerary as accordion
    function renderItineraryAccordion(text) {
      const lines = text.split('\n');
      let html = '';
      let inDay = false;
      let dayBody = '';
      let currentSection = '';
      let nonDayContent = '';

      const flushDay = () => {
        if (inDay) {
          html += `<div class="day-body">${dayBody}</div></details>`;
          dayBody = '';
          inDay = false;
        }
      };

      const addTimeBlock = () => {
        if (currentSection) {
          dayBody += `</div>`;
          currentSection = '';
        }
      };

      const TIME_ICONS = { Morning: 'üåÖ', Afternoon: '‚òÄÔ∏è', Evening: 'üåô' };

      for (const line of lines) {
        if (line.startsWith('## Day') || line.startsWith('## day')) {
          flushDay();
          const full = line.replace('## ', '').trim();
          const colonIdx = full.indexOf(':');
          const dayNum = colonIdx > -1 ? full.slice(0, colonIdx).trim() : full;
          const dayTitle = colonIdx > -1 ? full.slice(colonIdx + 1).trim() : '';
          html += `<details class="day-accordion">
            <summary class="day-summary">
              <span class="day-number">${dayNum}</span>
              <span class="day-title">${dayTitle}</span>
              <span class="day-arrow">‚ñæ</span>
            </summary>`;
          inDay = true;
          dayBody = '';

        } else if (line.startsWith('## ') && inDay) {
          // Non-day ## heading inside a day (edge case) ‚Üí treat as normal
          addTimeBlock();
          dayBody += `<h2 class="it-h2">${line.replace('## ','')}</h2>`;

        } else if (line.startsWith('## ') && !inDay) {
          // Practical Tips or other top-level section
          nonDayContent += `<h2 class="tips-heading" style="font-family: 'Playfair Display', serif; color: var(--rust); margin: var(--space-lg) 0 var(--space-md);">${line.replace('## ','')}</h2>`;

        } else if (line.startsWith('### ') && inDay) {
          addTimeBlock();
          const label = line.replace('### ', '').trim();
          const icon = TIME_ICONS[label] ?? 'üìç';
          currentSection = label;
          dayBody += `<div class="time-block">
            <h3 class="time-label">${icon} ${label}</h3>`;

        } else if (inDay) {
          const formatted = formatLine(line);
          if (formatted) dayBody += formatted;

        } else {
          const formatted = formatLine(line);
          if (formatted) nonDayContent += formatted;
        }
      }

      flushDay();

      if (nonDayContent) {
        html += `<div class="practical-tips">${nonDayContent}</div>`;
      }

      return html;
    }

    function formatLine(line) {
      if (!line.trim()) return '';
      if (line.startsWith('- ')) return `<p>${formatInline(line.slice(2))}</p>`;
      return `<p>${formatInline(line)}</p>`;
    }

    function formatInline(text) {
      return text
        .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.+?)\*/g, '<em>$1</em>');
    }

    // Cost estimation handler
    async function handleCostSubmit(e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const dest = formData.get('cost-destination');
      const dur = formData.get('cost-duration');
      const travelers = formData.get('cost-travelers');
      const accommodation = formData.get('cost-accommodation');
      const style = formData.get('cost-style');

      if (!dest || !dur) {
        alert('Please fill in all required fields');
        return;
      }

      // Show loading dialog
      loadingDialog.showModal();

      try {
        const prompt = `Return ONLY valid JSON, no markdown, for travel budget:
Destination: ${dest}, Duration: ${dur}, ${travelers} travelers,
${accommodation}, ${style} style.
{"flights":{"range":"$X-$Y","total":"$Z"},
 "accommodation":{"range":"$X-$Y","total":"$Z"},
 "food":{"range":"$X-$Y","total":"$Z"},
 "activities":{"range":"$X-$Y","total":"$Z"},
 "transport":{"range":"$X-$Y","total":"$Z"},
 "misc":{"range":"$X-$Y","total":"$Z"},
 "grandTotal":"$Z"}`;

        const result = await callQwen(prompt);
        // Remove any markdown code block markers
        const cleanResult = result.replace(/```json\n?/, '').replace(/\n?```/, '').trim();
        const data = JSON.parse(cleanResult);

        // Render cost results
        costResults.innerHTML = `
          <div class="cost-grid">
            <div class="card reveal">
              <h3>Flights</h3>
              <p>Range: ${data.flights.range}</p>
              <p>Total: ${data.flights.total}</p>
              <div class="progress-bar">
                <div class="progress-fill" style="--progress: 25%"></div>
              </div>
            </div>
            <div class="card reveal">
              <h3>Accommodation</h3>
              <p>Range: ${data.accommodation.range}</p>
              <p>Total: ${data.accommodation.total}</p>
              <div class="progress-bar">
                <div class="progress-fill" style="--progress: 35%"></div>
              </div>
            </div>
            <div class="card reveal">
              <h3>Food</h3>
              <p>Range: ${data.food.range}</p>
              <p>Total: ${data.food.total}</p>
              <div class="progress-bar">
                <div class="progress-fill" style="--progress: 20%"></div>
              </div>
            </div>
            <div class="card reveal">
              <h3>Activities</h3>
              <p>Range: ${data.activities.range}</p>
              <p>Total: ${data.activities.total}</p>
              <div class="progress-bar">
                <div class="progress-fill" style="--progress: 15%"></div>
              </div>
            </div>
            <div class="card reveal">
              <h3>Transport</h3>
              <p>Range: ${data.transport.range}</p>
              <p>Total: ${data.transport.total}</p>
              <div class="progress-bar">
                <div class="progress-fill" style="--progress: 10%"></div>
              </div>
            </div>
            <div class="card reveal">
              <h3>Miscellaneous</h3>
              <p>Range: ${data.misc.range}</p>
              <p>Total: ${data.misc.total}</p>
              <div class="progress-bar">
                <div class="progress-fill" style="--progress: 5%"></div>
              </div>
            </div>
          </div>
          <div class="grand-total-card card reveal" style="background: color-mix(in srgb, var(--gold) 20%, transparent); margin-top: var(--space-lg);">
            <h2 style="font-family: 'Playfair Display', serif; color: var(--deep); text-align: center;">Grand Total: ${data.grandTotal}</h2>
          </div>
          <p style="color: var(--muted); font-size: var(--text-sm); margin-top: var(--space-md);">‚ö†Ô∏è Disclaimer: These are estimated costs based on average prices. Actual costs may vary depending on season, availability, and personal choices.</p>
        `;

        loadingDialog.close();
        successDialog.showModal();
      } catch (error) {
        loadingDialog.close();
        alert('Error generating cost estimate: ' + error.message);
        console.error('Cost estimation error:', error);
      }
    }

    // Packing list handler
    async function handlePackingSubmit(e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const dest = formData.get('pack-destination');
      const dur = formData.get('pack-duration');
      const season = formData.get('pack-season');
      const tripType = formData.get('pack-trip-type');

      if (!dest || !dur) {
        alert('Please fill in all required fields');
        return;
      }

      // Show loading dialog
      loadingDialog.showModal();

      try {
        const prompt = `Return ONLY valid JSON for packing list:
${dest}, ${dur}, ${season}, ${tripType}.
{"clothing":["item1","item2"...],"toiletries":[...],"documents":[...],
 "electronics":[...],"health":[...],"extras":[...],"categories": {}}`;

        const result = await callQwen(prompt);
        // Remove any markdown code block markers
        const cleanResult = result.replace(/```json\n?/, '').replace(/\n?```/, '').trim();
        const data = JSON.parse(cleanResult);

        // Group items by category using Object.groupBy
        const groupedItems = {};
        for (const [category, items] of Object.entries(data)) {
          if (Array.isArray(items)) {
            groupedItems[category] = items.map(item => ({
              id: crypto.randomUUID(),
              name: item,
              checked: false
            }));
          }
        }

        // Render packing list
        let html = '';
        for (const [category, items] of Object.entries(groupedItems)) {
          html += `
            <div class="card reveal">
              <h3 style="font-family: 'Playfair Display', serif; color: var(--deep); margin-bottom: var(--space-md); text-transform: capitalize;">${category}</h3>
              <ul style="list-style: none; padding: 0;">
          `;

          items.forEach(item => {
            html += `
              <li style="margin-bottom: var(--space-xs);">
                <label style="display: flex; align-items: center; cursor: pointer;">
                  <input type="checkbox"
                         data-item-id="${item.id}"
                         onchange="updatePackingItem('${item.id}', this.checked)"
                         style="margin-right: var(--space-sm);">
                  <span style="color: var(--muted);">${item.name}</span>
                </label>
              </li>
            `;
          });

          html += '</ul></div>';
        }

        packingResults.innerHTML = html;

        // Add copy button
        packingResults.innerHTML += `
          <button onclick="copyPackingList()" class="btn btn-secondary" style="margin-top: var(--space-lg);">Copy Packing List</button>
        `;

        loadingDialog.close();
        successDialog.showModal();
      } catch (error) {
        loadingDialog.close();
        alert('Error generating packing list: ' + error.message);
        console.error('Packing list error:', error);
      }
    }

    // Update packing item state
    function updatePackingItem(itemId, checked) {
      const items = JSON.parse(localStorage.getItem('packingItems') || '{}');
      items[itemId] = checked;
      localStorage.setItem('packingItems', JSON.stringify(items));
    }

    // Copy packing list to clipboard
    async function copyPackingList() {
      const packingText = Array.from(packingResults.querySelectorAll('input[type="checkbox"]'))
        .map(checkbox => {
          const name = checkbox.nextElementSibling.textContent;
          const status = checkbox.checked ? '‚úì' : '‚óã';
          return `${status} ${name}`;
        })
        .join('\n');

      try {
        await navigator.clipboard.writeText(packingText);
        alert('Packing list copied to clipboard!');
      } catch (err) {
        console.error('Failed to copy:', err);
      }
    }

    // Contact form handler
    async function handleContactSubmit(e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const name = formData.get('contact-name');
      const email = formData.get('contact-email');
      const subject = formData.get('contact-subject');
      const message = formData.get('contact-message');

      if (!name || !email || !subject || !message) {
        alert('Please fill in all required fields');
        return;
      }

      try {
        // In a real app, you would send this to your backend
        // For now, just show success
        successDialog.showModal();

        // Reset form
        e.target.reset();
      } catch (error) {
        alert('Error sending message: ' + error.message);
      }
    }

    // Page switching with View Transitions (global functions for HTML onclick)
    function showPage(pageName) {
      if (currentActivePage === pageName) return;

      const currentPage = document.getElementById(currentActivePage);
      const newPage = document.getElementById(pageName);

      if (!newPage) return;

      if (!document.startViewTransition) {
        _switchPage(pageName);
        return;
      }

      document.startViewTransition(() => _switchPage(pageName));
    }

    function _switchPage(pageName) {
      document.getElementById(currentActivePage).hidden = true;
      document.getElementById(pageName).hidden = false;
      currentActivePage = pageName;
    }

    // Initialize the app when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Make sure the home page is visible initially
      document.getElementById('home').hidden = false;

      // Set the current active page to home
      currentActivePage = 'home';

      init();
    });

    // Make functions available globally for HTML onclick attributes
    window.showPage = showPage;
    window.updatePackingItem = updatePackingItem;
    window.copyPackingList = copyPackingList;
  </script>
</body>
</html>